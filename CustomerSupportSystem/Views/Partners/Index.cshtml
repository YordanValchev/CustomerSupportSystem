@model PartnersQueryModel

@{
    ViewData["Title"] = "Partners";
    ViewData["ActivePage"] = NavPagesService.AllPartners;
}

<div class="row">
    <div class="col-md-10">
        <form method="get">
            <div class="row">
                <div class="col-md-4">
                    <select asp-for="ConsultantId" class="form-control">
                        <option selected value="">All consultants</option>
                        @foreach (var consultant in Model.Consultants)
                        {
                            <option value="@consultant.Id">@consultant.Name</option>
                        }
                    </select>
                </div>
                <div class="col-md-6">
                    <input asp-for="Filter" class="form-control" placeholder="Search">
                    <span asp-validation-for="Filter" class="small text-danger"></span>
                </div>
                <div class="col-md-2">
                    <input class="btn btn-primary" role="button" type="submit" value="Apply" />
                </div>
            </div>
        </form>
    </div>
    <div class="col-md-2 text-center">
        <a class="btn btn-primary" role="button" id="AddPartner" asp-area="" asp-controller="Partners" asp-action="Add">
            <i class="bi bi-building-add"></i>
            Add partner
        </a>
    </div>
</div>
<br />
<div class="text-center">
    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Id">
                        @Html.DisplayNameFor(model => model.Partners.First().Id)
                        <i class="bi @Model.SortFields.IdImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Name">
                        @Html.DisplayNameFor(model => model.Partners.First().Name)
                        <i class="bi @Model.SortFields.NameImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Address">
                        @Html.DisplayNameFor(model => model.Partners.First().Address)
                        <i class="bi @Model.SortFields.AddressImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.City">
                        @Html.DisplayNameFor(model => model.Partners.First().City)
                        <i class="bi @Model.SortFields.CityImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Country">
                        @Html.DisplayNameFor(model => model.Partners.First().Country)
                        <i class="bi @Model.SortFields.CountryImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Postcode">
                        @Html.DisplayNameFor(model => model.Partners.First().Postcode)
                        <i class="bi @Model.SortFields.PostcodeImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.RegistrationNumber">
                        @Html.DisplayNameFor(model => model.Partners.First().RegistrationNumber)
                        <i class="bi @Model.SortFields.RegistrationNumberImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.TaxNumber">
                        @Html.DisplayNameFor(model => model.Partners.First().TaxNumber)
                        <i class="bi @Model.SortFields.TaxNumberImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Website">
                        @Html.DisplayNameFor(model => model.Partners.First().Website)
                        <i class="bi @Model.SortFields.WebsiteImageClass"></i>
                    </a>
                </th>
                <th scope="col">
                    <a class="text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Index"
                       asp-route-sortOrder="@Model.SortFields.Consultant">
                        @Html.DisplayNameFor(model => model.Partners.First().Consultant)
                        <i class="bi @Model.SortFields.ConsultantImageClass"></i>
                    </a>
                </th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            @foreach(var partner in Model.Partners)
            {
                <tr>
                    <th scope="row">
                        <a class="link-dark link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Id
                        </a>
                    </th>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Name
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Address
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.City
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Country
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Postcode
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.RegistrationNumber
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.TaxNumber
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Website
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id">
                            @partner.Consultant
                        </a>
                    </td>
                    <td>
                        <a class="link-dark text-decoration-none" asp-area="" asp-controller="Partners" asp-action="Details" asp-route-id="@partner.Id" title="Details">
                            <i class="bi bi-card-text"></i>
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

@if (!Model.Partners.Any())
{
    <h6 class="text-center">No records found by the given criteria!</h6>
}
else
{
    var totalPages = Math.Ceiling((double)Model.TotalPartnersCount / PartnersQueryModel.RowsPerPage);

    <div class="row">
        <nav aria-label="Table navigation">
            <ul class="pagination">

                @if (Model.CurrentPage > 1)
                {
                    int previousPage = Model.CurrentPage - 1;

                    <li class="page-item">
                        <a class="page-link" asp-area="" asp-controller="Partners" asp-action="Index" asp-route-currentPage="@previousPage">Previous</a>
                    </li>
                }
                else
                {
                    <li class="page-item disabled">
                        <a class="page-link">Previous</a>
                    </li>
                }

                @for (int currentPage = 1; currentPage <= totalPages; currentPage++)
                {
                    string activeClass = currentPage == Model.CurrentPage ? "active" : string.Empty;

                    <li class="page-item @activeClass">
                        <a class="page-link" asp-area="" asp-controller="Partners" asp-action="Index" asp-route-currentPage="@currentPage">@currentPage</a>
                    </li>
                }

                @if (Model.CurrentPage < totalPages)
                {
                    int nextPage = Model.CurrentPage + 1;

                    <li class="page-item">
                        <a class="page-link" asp-area="" asp-controller="Partners" asp-action="Index" asp-route-currentPage="@nextPage">Next</a>
                    </li>
                }
                else
                {
                    <li class="page-item disabled">
                        <a class="page-link">Next</a>
                    </li>
                }
            </ul>
        </nav>
    </div>
}


